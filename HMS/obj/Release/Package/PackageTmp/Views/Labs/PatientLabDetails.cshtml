@{
}
@model HmsServices.Models.AddLabToPatientResponseModel

<style>
    .mian-container-opdp {
        margin-top: 50px !important;
    }

    #labDd {
        height: 37px;
    }
    #customers {
        font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
        border-collapse: collapse;
        width: 100%;
    }

    #customers td, #customers th {
        border: 1px solid #ddd;
        padding: 8px;
    }

    #customers tr:nth-child(even) { background-color: #f2f2f2; }

    #customers tr:hover { background-color: #ddd; }

    #customers th {
        padding-top: 12px;
        padding-bottom: 12px;
        text-align: left;
        background-color: #4CAF50;
        color: white;
    }
</style>

@Styles.Render("~/Content/PatientLabs_AddEdit")

<nav class="navbar navbar-transparent navbar-absolute">
    <div class="container-fluid" style="margin-left: 12px;">
        <div class="navbar-header">
            <button id="backToOpdpList" type="submit" class="btn btn-primary pull-right">Back<div class="ripple-container"></div></button>
        </div>
    </div>
</nav>
<div class="content mian-container-opdp">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header" data-background-color="purple">
                        <h4 class="title">Lab SLIP</h4>
                        <p class="category">Complete The follow form</p>
                    </div>
                    <div class="card-content">
                        <div class="row opdFormheading">
                            <div class="col-md-2">
                                <div class="form-group label-floating">
                                    <label class="">Lab No.</label>
                                    <input id="LabNo" type="text" value=" @Model.PatientInfo.Id " class="form-control other-cons" disabled>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group label-floating">
                                    <label class="">Date & Time</label>
                                    <input id="dateTime" type="text" class="form-control other-cons" value=" @DateTime.Now.ToLongDateString() @DateTime.Now.ToLongTimeString() " disabled>
                                </div>
                            </div>

                            <div class="col-md-3">
                                <div class="form-group label-floating">
                                    <label class="">MR/Patient No.</label>
                                    <input id="ptid" type="text" class="form-control other-cons" value=" @Model.PatientInfo.PatientNo ">
                                </div>
                            </div>
                        </div>
                        <div class="row">

                            <div class="col-md-3">
                                <div class="form-group label-floating">
                                    <label class="">Requested</label>
                                    <input id="Req" type="text" class="form-control pLabRequired" readonly="" value=" @Model.PatientInfo.RequestedOn ">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group label-floating">
                                    <label class="">Reported</label>
                                    <input id="Repo" type="text" value=" @Model.PatientInfo.ReportedOn "  readonly="" class="form-control">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group label-floating">
                                    <label class="">Referred By</label>
                                    <input id="Regis" type="text" value=" @Model.PatientInfo.RegisteredBy " class="form-control pLabRequired">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group label-floating">
                                    <label class="">Performed By</label>
                                    <input id="Perfor" type="text" value=" @Model.PatientInfo.PerformedBy " class="form-control pLabRequired">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group label-floating">
                                    <label class="">Full Name</label>
                                    <input id="fname" type="text" value=" @Model.PatientInfo.Name " class="form-control pLabRequired">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group label-floating">
                                    <label class="">S/O, W/O, D/O</label>
                                    <input id="gname" type="text" value=" @Model.PatientInfo.GuardianName " class="form-control pLabRequired">
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group label-floating">
                                    <label class="">Phone No.</label>
                                    <input id="phNo" type="text" value="&nbsp;@Model.PatientInfo.Phone " class="form-control">
                                </div>
                            </div>


                            <div class="col-md-3">
                                <div class="form-group label-floating">
                                    <label class="">Martial Status</label>
                                    <select id="mstatus" class="form-control">
                                        <option value="1">Married</option>
                                        <option selected="" value="0">Unmarried</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-2">
                                <div class="form-group label-floating">
                                    <label class="">Age</label>
                                    <input id="age" type="text" value=" @Model.PatientInfo.Age " class="form-control">
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group label-floating">
                                    <label>Gender</label>
                                    <select id="gender" class="form-control">
                                        <option selected="" value="1">Male</option>
                                        <option value="0">Female</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group label-floating">
                                    <label>Blood Group</label>
                                    <select id="BloodGroupDd" class="form-control">
                                        <option value="None">None</option>
                                        <option value="A+">A+</option>
                                        <option value="O+">O+</option>

                                        <option value="B+">B+</option>
                                        <option value="AB+">AB+</option>

                                        <option value="A-">A-</option>
                                        <option value="O-">O-</option>
                                        <option value="B-">B-</option>
                                        <option value="AB-" selected="">AB-</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group label-floating">
                                    <label >Address</label>
                                    <input id="address" type="text" value=" @Model.PatientInfo.Address " class="form-control">
                                </div>
                            </div>

                        </div>


                        <div class="row">
                            <div class="col-md-2">
                                <div class="form-group label-floating">
                                    <label class="">Age</label>
                                    <input id="age" type="text" value=" @Model.PatientInfo.Age " class="form-control">
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group label-floating">
                                    <label class="">Total Amount</label>
                                    <input id="tamount" type="text" readonly="" value=" @Model.PatientInfo.Amount " class="form-control">
                                </div>
                            </div>   
                            
                            <div class="col-md-2">
                                <div class="form-group label-floating">
                                    <label class="">Discount</label>
                                    <input id="discount" type="text" value=" @Model.PatientInfo.Discount " class="form-control numOnly">
                                </div>
                            </div>   
                            
                            <div class="col-md-3">
                                <div class="form-group label-floating">
                                    <label class="">Discount By</label>
                                    <input id="discountBy" type="text" value=" @Model.PatientInfo.DiscountBy " class="form-control">
                                </div>
                            </div>                
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group label-floating">
                                   
                                   
                                       
                                        @{
                                            <label class="control-label">Associated Lab Tests</label>
                                            <ul id="assoLabUl">
                                                @if (Model!=null && Model.PatientLabs != null && Model.PatientLabs.Any())
                                                {
                                                    foreach (var lab in Model.PatientLabs)
                                                    {
                                                      <li id="sp_@lab.Id"><a data-toggle="modal" data-target="#exampleModal" onclick="showpLab(@Json.Encode(lab))" style="cursor: pointer" href="">@lab.TestName (Rs. @lab.Lab_Test.Fee)</a>
                                                       <span style="cursor: pointer" title="remove this lab"><a onclick="removeLab(@Json.Encode(lab))" style="color:red"> &nbsp;  &nbsp;Remove</a></span>
                                                     </li>
                                                    }
                                                }
                                            </ul>
                                        }
                                       
                                                                          
                                    
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary pull-right" id="createNewOpdFormBtn">Update</button>
                        <button style="display: none" type="submit" class="btn btn-default pull-right" id="addnewtest">Associate Test</button>
                        <button id="createNewTest" type="submit" class="btn btn-primary pull-right" >
                            Create Mix Test
                            <div class="ripple-container"></div>
                        </button>
                        <button  class="btn btn-primary pull-right" id="printLab">Print</button>

                        <img src="~/Images/loading.gif" class="pull-right loading-docs displayNone" />
                        <div class="clearfix"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Add New Lab</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="parmForm">
                    <div class="form-group label-floating" style="margin-bottom: 10px" id="labddpat">
                        <label class="control-label">Lab Tests</label>
                        <select id="labDd" class="form-control">
                            @{
                                <option data-fee="" id="0" value="0">Select Lab Test</option>
                                if (Model != null && Model.LabTestsDd != null)
                                {
                                    foreach (var test in Model.LabTestsDd)
                                    {
                                        var selected = "";
                                        if (test.id == Model.PatientInfo.Id)
                                        {
                                            selected = "selected='selected'";
                                        }
                                        <option @selected value="@test.id">@test.Name</option>
                                    }
                                }
                            }
                        </select>
                    </div>
                    <table id="customers">
                        <tr>
                            <th>Parameter Name</th>
                            <th>Normal Value</th>
                            <th>Actual Value</th>
                        </tr>

                    </table>
                </form>
            </div>
            <div class="modal-footer" style="margin-top: 5%; margin-right: 3%;">
                <button type="button" class="btn btn-primary" style="display: none" id="addPlab">Add</button>
                <button type="button" class="btn btn-primary" style="display: none" id="updatePlabPe">Update</button>
            </div>
        </div>
    </div>
</div>


    <div class="modal fade" id="createNewTestModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="">Add Mix Lab</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label for="labname" class="form-control-label">Name</label>
                            <input type="text" class="form-control labclsMix" id="labname">
                        </div>
                        <div class="form-group">
                            <label for="labfee" class="form-control-label">Fee</label>
                            <input type="text" class="form-control labclsMix" id="labfee">
                        </div>
                      
                        <div class="form-group">
                            <label for="testNameTb" class="form-control-label">Test Name</label>
                            <select class="form-control" id="testNameTb" style="width: 100%">
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-control-label">Parameter Name</label>
                            <select id="parmMix" multiple="multiple" style="width: 100%"></select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="addMixlab">Add</button>
                </div>
            </div>
        </div>
    </div>


</div>
@Scripts.Render("~/bundles/PatientLabs_AddEdit")
<script>
    var LabTestsDdModelData= @Html.Raw(Json.Encode(Model.PatientLabs));
    var PatientLabIdObj= @Html.Raw(Json.Encode(@Model.PatientInfo.Id));
    var bGroup = @Html.Raw(Json.Encode(Model.PatientInfo.BloodGroup));
    var mStatus = @Html.Raw(Json.Encode(Model.PatientInfo.MaritalStatus));
    var gen = @Html.Raw(Json.Encode(Model.PatientInfo.Gender));
</script>